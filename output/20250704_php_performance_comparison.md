---
marp: true
theme: custom
---

## PHP実行環境パフォーマンス比較

各PHP実行環境の性能比較検証

---

## 共通環境情報

### アプリケーション基盤
- **PHP**: 8.3.20
- **データベース**: MySQL 8.0
- **コンテナ**: Docker + Docker Compose
- **監視**: OpenTelemetry (Jaeger)

---

## 異なる構成部分

### NTS（シングルスレッド）構成
- フレームワーク　Laravel 12
#### 対象実行環境
- Apache + mod_php 
- Nginx + php-fpm 

### ZTS（マルチスレッド）構成
- フレームワーク Laravel Octane
#### 対象実行環境
- Swoole + Nginx (Laravel Octane)
- FrankenPHP (Laravel Octane)

---

## 計測項目

- CPU使用率
- メモリ使用量
- PHPプロセス数
- スループット
- レスポンスタイム

---

## 比較検証のポイント

1. **レスポンス時間**: 同一負荷での応答速度比較
2. **スループット**: 単位時間あたりの処理能力
3. **メモリ使用量**: 各構成でのメモリ効率
4. **CPU使用率**: 処理負荷によるCPU消費
5. **同時接続数**: 最大同時接続処理能力
6. **エラー率**: 高負荷時のエラー発生率

---

## 計測ツール

### メインツール
- **OpenTelemetry**: アプリケーション監視
- **k6**: 負荷テスト

### OpenTelemetryを選んだ理由
- ZTS環境に対応したプロファイリングツールが少ない
- 詳細: https://zenn.dev/booost/articles/a691d0fe7aeae6

---

## 計測しない項目

**ブラウザレンダリング**
- PHPはWebAPIサーバーとして振る舞うことが多いため

---

## テストシナリオ

**記事投稿 + 記事取得**
- 実際のWebアプリケーションを想定
- CRUD操作の性能を検証

---

## データベース設計

**ER図を挿入**
- 記事テーブル
- ユーザーテーブル
- 関連性を含む設計